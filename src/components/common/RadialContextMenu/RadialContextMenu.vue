<template>
  <div
    v-show="isOpened"
    class="radialMenu"
    :style="{ width: size + 'px', height: size + 'px' }"
  >
    <svg class="icons">
      <symbol id="return" viewBox="0 0 489.394 489.394">
        <path
          d="M375.789,92.867H166.864l17.507-42.795c3.724-9.132,1-19.574-6.691-25.744c-7.701-6.166-18.538-6.508-26.639-0.879L9.574,121.71c-6.197,4.304-9.795,11.457-9.563,18.995c0.231,7.533,4.261,14.446,10.71,18.359l147.925,89.823c8.417,5.108,19.18,4.093,26.481-2.499c7.312-6.591,9.427-17.312,5.219-26.202l-19.443-41.132h204.886c15.119,0,27.418,12.536,27.418,27.654v149.852c0,15.118-12.299,27.19-27.418,27.19h-226.74c-20.226,0-36.623,16.396-36.623,36.622v12.942c0,20.228,16.397,36.624,36.623,36.624h226.74c62.642,0,113.604-50.732,113.604-113.379V206.709C489.395,144.062,438.431,92.867,375.789,92.867z"
        ></path>
      </symbol>
      <symbol id="close" viewBox="0 0 41.756 41.756">
        <path
          d="M27.948,20.878L40.291,8.536c1.953-1.953,1.953-5.119,0-7.071c-1.951-1.952-5.119-1.952-7.07,0L20.878,13.809L8.535,1.465c-1.951-1.952-5.119-1.952-7.07,0c-1.953,1.953-1.953,5.119,0,7.071l12.342,12.342L1.465,33.22c-1.953,1.953-1.953,5.119,0,7.071C2.44,41.268,3.721,41.755,5,41.755c1.278,0,2.56-0.487,3.535-1.464l12.343-12.342l12.343,12.343c0.976,0.977,2.256,1.464,3.535,1.464s2.56-0.487,3.535-1.464c1.953-1.953,1.953-5.119,0-7.071L27.948,20.878z"
        ></path>
      </symbol>
      <symbol id="shrimb" viewBox="0 0 512.105 512.105">
        <g>
          <circle cx="296.105" cy="196.052" r="10" />
          <path
            d="m452.105 66.052h-50c-5.522 0-10 4.477-10 10s4.478 10 10 10h50c22.056 0 40 17.944 40 40 0 16.195-9.68 30.162-23.552 36.447 2.275-5.021 3.552-10.586 3.552-16.447 0-22.056-17.944-40-40-40-5.522 0-10 4.477-10 10s4.478 10 10 10c11.028 0 20 8.972 20 20s-8.972 20-20 20h-9.375c-3.794-.475-24.474-3.059-50.813-6.182-5.483-.65-10.457 3.269-11.108 8.753-.65 5.484 3.269 10.458 8.753 11.108 9.688 1.148 18.608 2.224 26.198 3.147-45.416 32.063-126.156 83.173-165.655 83.173-27.598 0-50-22.377-50-50 0-27.57 22.43-50 50-50 8.05 0 24.941 1.272 50.203 3.78 5.514.55 10.394-3.468 10.939-8.963.546-5.496-3.468-10.394-8.963-10.939-26.281-2.609-43.35-3.878-52.18-3.878h-66c-60.568 0-96.679 29.934-96.579 29.884-45.038 32.701-69.39 87.24-67.413 140.491 2.719 72.816 53.202 129.626 141.273 129.626h88.72c2.652 0 5.195-1.054 7.071-2.929l40-40c2.859-2.86 3.715-7.162 2.168-10.898-1.548-3.737-5.194-6.173-9.239-6.173h-17.192l6.894-27.575c.747-2.987.076-6.152-1.819-8.58-1.895-2.427-4.803-3.846-7.882-3.846-40.706 0-79.585 19.439-103.999 51.999l-10.738 14.315c-23.868-16.076-37.758-44-34.888-74.21 3.885-40.912 40.087-70.721 80.708-72.055 12.562 12.27 29.349 19.402 46.956 19.898l97.961 36.966v33.085c0 5.523 4.478 10 10 10s10-4.477 10-10v-40c0-4.161-2.576-7.887-6.47-9.356l-54.707-20.644h83.969l17.721 53.162c1.747 5.24 7.409 8.072 12.649 6.325 5.239-1.747 8.071-7.41 6.325-12.649l-20-60c-1.361-4.083-5.183-6.838-9.487-6.838h-79.06c23.569-11.237 48.397-25.922 70.551-40.146.534.088 1.079.146 1.639.146h92.87c5.522 0 10-4.477 10-10s-4.478-10-10-10h-64.714c13.396-9.244 23.464-16.612 28.034-20h26.68c33.084 0 60-26.916 60-60s-26.917-59.997-60.001-59.997zm-215.003 300.783-4.804 19.218h-5.622c-17.593 0-34.974 3.205-51.281 9.297 16.989-15.673 38.676-25.739 61.707-28.515zm-10.427 39.217h19.287l-20 20h-45.857c-6.247 0-12.36-.701-18.298-2.089 19.51-11.632 41.98-17.911 64.868-17.911zm-206.577-90.371c-.555-14.958 1.29-30.148 5.365-44.836 13.833 24.009 32.74 44.687 55.675 60.776-.224 1.544-.421 3.093-.568 4.645-.882 9.279-.515 18.44 1.077 27.382-20.336-3.467-40.036-10.671-57.814-21.174-2.136-8.599-3.391-17.593-3.735-26.793zm97.915 108.761c-38.002-5.38-67.003-24.216-83.382-54.054 16.938 7.338 34.939 12.201 53.261 14.358 6.558 15.652 16.908 29.253 30.121 39.696zm-31.408-113.621c-22.398-17.203-40.047-39.514-51.622-65.298 8.241-17.097 19.54-32.207 33.177-44.439 9.999 26.891 28.837 49.968 53.179 65.234-15.858 11.434-27.88 26.818-34.734 44.503zm55.084-56.025c-27.183-13.397-47.891-37.704-56.763-66.514 22.777-14.744 49.371-22.24 79.179-22.24h17.077c-12.993 12.716-21.077 30.438-21.077 50.01 0 10.967 2.571 21.662 7.394 31.305-8.862 1.394-17.563 3.895-25.81 7.439z"
          />
          <circle cx="326.105" cy="164.052" r="10" />
        </g>
      </symbol>
    </svg>
    <svg
      class="menu"
      :class="{ inner: menu.inner, outer: menu.outer }"
      :width="size"
      :height="size"
      viewBox="-50 -50 100 100"
      v-for="(menu, index) in openedMenu"
      :key="index"
      :id="'lvl' + menu.level"
    >
      <g
        @click="$_sectorClick"
        @mouseover="$_sectorHover"
        :class="{
          sector: sector.id,
          dummy: !sector.id,
          selected: menu.selectedIndex == sector.itemIndex,
        }"
        v-for="(sector, index) in menu.sectors"
        :key="index"
        :data-id="sector.id"
        :data-index="index"
        :transform="sector.transform"
        :data-item-index="sector.itemIndex"
      >
        <path :d="sector.d"></path>
        <use
          v-if="sector.icon"
          :xlink:href="sector.icon"
          :x="sector.centerX"
          :y="sector.centerY"
          :transform="sector.useTransform"
          width="10"
          height="10"
          fill="white"
        ></use>
      </g>
      <!-- <g class="center" @click="$_centerClick">
        <circle :r="menu.centerRadius"></circle>
        <use
          :xlink:href="menu.centerIcon"
          :transform="menu.centerTransform"
          :width="menu.centerSize"
          :height="menu.centerSize"
        ></use>
      </g> -->
    </svg>
  </div>
</template>
<script src="./RadialContextMenu"></script>
<style lang="css" scoped>
div.radialMenu {
  user-select: none;
}

div.radialMenu > svg.icons {
  display: none;
}

div.radialMenu > svg.menu {
  position: absolute;
  overflow: visible;
  transition: 0.2s;
  transition-timing-function: ease-out;
   border: 2px solid rgb(90, 170, 240);
  border-radius: 50%;
  transition: all .2s ease;
}

div.radialMenu > svg.menu.inner {
  transform: scale(0.66) rotate(-10deg);
  opacity: 0;
  visibility: hidden;
}

div.radialMenu > svg.menu.outer {
  transform: scale(1.5) rotate(10deg);
  opacity: 0;
  visibility: hidden;
}

div.radialMenu > svg.menu > g > path {
  fill: white;
}

div.radialMenu > svg.menu > g.sector > path {
  cursor: pointer;
}

div.radialMenu > svg.menu > g.sector > text,
div.radialMenu > svg.menu > g.sector > use {
  cursor: pointer;
  fill: black;
  transition: fill 0.2s ease;
}

div.radialMenu > svg.menu > g.sector.selected > path {
  fill: rgb(90, 170, 240) !important;
}

div.radialMenu > svg.menu > g.center > circle {
  cursor: pointer;
  fill: #00000050;
}

div.radialMenu > svg.menu > g.center > text,
div.radialMenu > svg.menu > g.center > use {
  cursor: pointer;
  fill: white;
}
</style>
